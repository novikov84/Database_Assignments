# Курс "Системы хранения и обработки данных"

## Домашнее задание 2. Группировка данных и оконные функции.

## Пункты задания:

### Создать таблицы со следующими структурами и загрузить данные из csv-файлов

![Transaction datatypes](transaction.png)

![Customer datatypes](customer.png)

Все скрипты для выполнения последующих заданий есть в файле [script.sql](script.sql)

### Вывести распределение (количество) клиентов по сферам деятельности, отсортировав результат по убыванию количества.
![Question 1](1.png)

### Найти сумму транзакций за каждый месяц по сферам деятельности, отсортировав по месяцам и по сфере деятельности. 
![Question 2](2.png)

### Вывести количество онлайн-заказов для всех брендов в рамках подтвержденных заказов клиентов из сферы IT. 
![Question 3](3.png)

### Найти по всем клиентам сумму всех транзакций (list_price), максимум, минимум и количество транзакций, отсортировав результат по убыванию суммы транзакций и количества клиентов. Выполните двумя способами: используя только group by и используя только оконные функции. Сравните результат.
![Question 4](4.png)

### Найти имена и фамилии клиентов с минимальной/максимальной суммой транзакций за весь период (сумма транзакций не может быть null). Напишите отдельные запросы для минимальной и максимальной суммы. 
![Question 5](5.png)

### Вывести только самые первые транзакции клиентов. Решить с помощью оконных функций.
![Question 6](6.png)

### Вывести имена, фамилии и профессии клиентов, между транзакциями которых был максимальный интервал (интервал вычисляется в днях)
![Question 7](7.png)


